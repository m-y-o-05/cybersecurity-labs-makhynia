/*
 * EmailEncryptorWindow_Slots.cpp
 *
 * –§–∞–π–ª –∑ –æ–±—Ä–æ–±–Ω–∏–∫–∞–º–∏ –ø–æ–¥—ñ–π (slots) –≥–æ–ª–æ–≤–Ω–æ–≥–æ –≤—ñ–∫–Ω–∞.
 * –ú—ñ—Å—Ç–∏—Ç—å –≤—Å—é –ª–æ–≥—ñ–∫—É –æ–±—Ä–æ–±–∫–∏ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—Ü—å–∫–∏—Ö –¥—ñ–π.
 */

#include "EmailEncryptorWindow.h"
#include <QMessageBox>
#include <QFileDialog>
#include <QFile>
#include <QTextStream>
#include <QFileInfo>
#include <QClipboard>
#include <QApplication>

/*
 * ============================================================================
 * –û–ë–†–û–ë–ù–ò–ö–ò –í–ö–õ–ê–î–ö–ò –ì–ï–ù–ï–†–ê–¶–Ü–á –ö–õ–Æ–ß–ê
 * ============================================================================
 */

/**
 * @brief –ì–µ–Ω–µ—Ä–∞—Ü—ñ—è –∫–ª—é—á–∞ —à–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è –∑ –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω–∏—Ö –¥–∞–Ω–∏—Ö.
 *
 * –ê–ª–≥–æ—Ä–∏—Ç–º —Ä–æ–±–æ—Ç–∏:
 * 1. –ó—á–∏—Ç—É—î –¥–∞–Ω—ñ –∑ –ø–æ–ª—ñ–≤ –≤–≤–µ–¥–µ–Ω–Ω—è (email, —ñ–º'—è, –ø—Ä—ñ–∑–≤–∏—â–µ, –¥–∞—Ç–∞).
 * 2. –ü–µ—Ä–µ–≤—ñ—Ä—è—î, —á–∏ –≤—Å—ñ –ø–æ–ª—è –∑–∞–ø–æ–≤–Ω–µ–Ω—ñ.
 * 3. –í–∏–∫–ª–∏–∫–∞—î –¥–≤–∏–∂–æ–∫ —à–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü—ñ—ó SHA-256 –∫–ª—é—á–∞.
 * 4. –í—ñ–¥–æ–±—Ä–∞–∂–∞—î –∑–≥–µ–Ω–µ—Ä–æ–≤–∞–Ω–∏–π –∫–ª—é—á —É —Ñ–æ—Ä–º–∞—Ç–æ–≤–∞–Ω–æ–º—É –≤–∏–≥–ª—è–¥—ñ.
 * 5. –ü–æ–∫–∞–∑—É—î –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –ø—Ä–æ —É—Å–ø—ñ—Ö.
 *
 * –§–æ—Ä–º–∞—Ç –∫–ª—é—á–∞: SHA-256 —Ö–µ—à –≤—ñ–¥ "–Ü–º'—è–ü—Ä—ñ–∑–≤–∏—â–µ–î–î–ú–ú–†–†–†–†".
 * –ü—Ä–∏–∫–ª–∞–¥: SHA256("–Ü–≤–∞–Ω–ü–µ—Ç—Ä–µ–Ω–∫–æ15031995") ‚Üí 64 hex-—Å–∏–º–≤–æ–ª–∏.
 */
void EmailEncryptorWindow::generateKey() {
    // ========== –ö–†–û–ö 1: –ó—á–∏—Ç—É–≤–∞–Ω–Ω—è —Ç–∞ –≤–∞–ª—ñ–¥–∞—Ü—ñ—è –≤—Ö—ñ–¥–Ω–∏—Ö –¥–∞–Ω–∏—Ö ==========

    // –ó—á–∏—Ç—É—î–º–æ email —Ç–∞ –≤–∏–¥–∞–ª—è—î–º–æ –∑–∞–π–≤—ñ –ø—Ä–æ–±—ñ–ª–∏ –ø–æ –∫—Ä–∞—è—Ö.
    QString email = key_emailEdit->text().trimmed();

    // –ó—á–∏—Ç—É—î–º–æ —ñ–º'—è —Ç–∞ –ø—Ä—ñ–∑–≤–∏—â–µ.
    QString firstName = key_firstNameEdit->text().trimmed();
    QString lastName = key_lastNameEdit->text().trimmed();

    // –ö–æ–Ω–≤–µ—Ä—Ç—É—î–º–æ –¥–∞—Ç—É –≤ —Ñ–æ—Ä–º–∞—Ç ddMMyyyy.
    QString birthDate = key_birthDateEdit->date().toString("ddMMyyyy");

    // –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞: —á–∏ –≤—Å—ñ –æ–±–æ–≤'—è–∑–∫–æ–≤—ñ –ø–æ–ª—è –∑–∞–ø–æ–≤–Ω–µ–Ω—ñ.
    if (email.isEmpty() || firstName.isEmpty() || lastName.isEmpty()) {
        // –ü–æ–∫–∞–∑—É—î–º–æ –ø–æ–ø–µ—Ä–µ–¥–∂–µ–Ω–Ω—è, —è–∫—â–æ —Ö–æ—á –æ–¥–Ω–µ –ø–æ–ª–µ –ø–æ—Ä–æ–∂–Ω—î.
        QMessageBox::warning(
            this,
            "–ü–æ–º–∏–ª–∫–∞",
            "–ó–∞–ø–æ–≤–Ω—ñ—Ç—å –≤—Å—ñ –ø–æ–ª—è!\n\n"
            "Email, —ñ–º'—è, –ø—Ä—ñ–∑–≤–∏—â–µ —Ç–∞ –¥–∞—Ç–∞ –Ω–∞—Ä–æ–¥–∂–µ–Ω–Ω—è —î –æ–±–æ–≤'—è–∑–∫–æ–≤–∏–º–∏."
            );
        return;  // –í–∏—Ö–æ–¥–∏–º–æ –∑ —Ñ—É–Ω–∫—Ü—ñ—ó –±–µ–∑ –≥–µ–Ω–µ—Ä–∞—Ü—ñ—ó –∫–ª—é—á–∞.
    }

    // ========== –ö–†–û–ö 2: –ì–µ–Ω–µ—Ä–∞—Ü—ñ—è –∫–ª—é—á–∞ —á–µ—Ä–µ–∑ –¥–≤–∏–∂–æ–∫ —à–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è ==========

    // –í–∏–∫–ª–∏–∫–∞—î–º–æ –º–µ—Ç–æ–¥ –¥–≤–∏–∂–∫–∞, —è–∫–∏–π:
    // 1. –û–±'—î–¥–Ω—É—î –¥–∞–Ω—ñ: firstName + lastName + birthDate.
    // 2. –û–±—á–∏—Å–ª—é—î SHA-256 —Ö–µ—à –≤—ñ–¥ –æ–±'—î–¥–Ω–∞–Ω–æ–≥–æ —Ä—è–¥–∫–∞.
    // 3. –ü–æ–≤–µ—Ä—Ç–∞—î —Å—Ç—Ä—É–∫—Ç—É—Ä—É EncryptionKey –∑ hex-–∫–ª—é—á–µ–º —Ç–∞ –º–µ—Ç–∞–¥–∞–Ω–∏–º–∏.
    currentKey = encryptionEngine->generateKey(
        email,
        firstName,
        lastName,
        birthDate
        );

    // ========== –ö–†–û–ö 3: –§–æ—Ä–º–∞—Ç—É–≤–∞–Ω–Ω—è —Ç–∞ –≤—ñ–¥–æ–±—Ä–∞–∂–µ–Ω–Ω—è –∫–ª—é—á–∞ ==========

    // –°—Ç–≤–æ—Ä—é—î–º–æ –≤—ñ–¥—Ñ–æ—Ä–º–∞—Ç–æ–≤–∞–Ω–∏–π —Ç–µ–∫—Å—Ç –¥–ª—è –≤—ñ–¥–æ–±—Ä–∞–∂–µ–Ω–Ω—è.
    QString keyFormatted = QString(
                               "üîê –ö–õ–Æ–ß –®–ò–§–†–£–í–ê–ù–ù–Ø\n"
                               "‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\n\n"
                               "Email: %1\n"                    // –ü—ñ–¥—Å—Ç–∞–≤–ª—è—î–º–æ email.
                               "–ü–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ñ –¥–∞–Ω—ñ: %2\n\n"      // –ü—ñ–¥—Å—Ç–∞–≤–ª—è—î–º–æ –æ–±'—î–¥–Ω–∞–Ω—ñ –¥–∞–Ω—ñ.
                               "–ê–ª–≥–æ—Ä–∏—Ç–º: SHA-256\n"
                               "–§–æ—Ä–º—É–ª–∞: SHA256(\"%2\")\n\n"   // –ü–æ–∫–∞–∑—É—î–º–æ —Ñ–æ—Ä–º—É–ª—É.
                               "–ö–ª—é—á (Hex):\n%3\n\n"           // –ü—ñ–¥—Å—Ç–∞–≤–ª—è—î–º–æ hex-–∫–ª—é—á.
                               "–ó–±–µ—Ä—ñ–≥–∞–π—Ç–µ —Ü–µ–π –∫–ª—é—á —É –±–µ–∑–ø–µ—á–Ω–æ–º—É –º—ñ—Å—Ü—ñ!\n"
                               "–í—ñ–Ω –Ω–µ–æ–±—Ö—ñ–¥–Ω–∏–π –¥–ª—è —à–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è —Ç–∞ —Ä–æ–∑—à–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è –≤–∞—à–∏—Ö –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å."
                               ).arg(currentKey.email)              // %1 - email.
                               .arg(currentKey.personalData)       // %2 - –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ñ –¥–∞–Ω—ñ.
                               .arg(currentKey.keyHex);            // %3 - hex-–∫–ª—é—á.

    // –í–∏–≤–æ–¥–∏–º–æ –≤—ñ–¥—Ñ–æ—Ä–º–∞—Ç–æ–≤–∞–Ω–∏–π —Ç–µ–∫—Å—Ç —É —Ç–µ–∫—Å—Ç–æ–≤–µ –ø–æ–ª–µ.
    key_generatedKeyEdit->setPlainText(keyFormatted);

    // ========== –ö–†–û–ö 4: –ü–æ–∫–∞–∑—É—î–º–æ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –ø—Ä–æ —É—Å–ø—ñ—Ö ==========

    QMessageBox::information(
        this,
        "–£—Å–ø—ñ—Ö",
        QString(
            "–ö–ª—é—á —É—Å–ø—ñ—à–Ω–æ –∑–≥–µ–Ω–µ—Ä–æ–≤–∞–Ω–æ!\n\n"
            "Email: %1\n"
            "–ü–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ñ –¥–∞–Ω—ñ: %2\n\n"
            "–†–µ–∫–æ–º–µ–Ω–¥—É—î—Ç—å—Å—è –∑–±–µ—Ä–µ–≥—Ç–∏ –∫–ª—é—á —É —Ñ–∞–π–ª –¥–ª—è –ø–æ–¥–∞–ª—å—à–æ–≥–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è."
            ).arg(email)
            .arg(firstName + lastName + birthDate)
        );
}

/**
 * @brief –ó–∞–ø–æ–≤–Ω–µ–Ω–Ω—è —Ñ–æ—Ä–º–∏ —Ç–µ—Å—Ç–æ–≤–∏–º–∏ –¥–∞–Ω–∏–º–∏.
 *
 * –®–≤–∏–¥–∫–µ –∑–∞–ø–æ–≤–Ω–µ–Ω–Ω—è —Ñ–æ—Ä–º–∏ –ø—Ä–∏–∫–ª–∞–¥–æ–º –¥–ª—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü—ñ—ó —Ä–æ–±–æ—Ç–∏.
 * –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –¥–ª—è —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è —Ç–∞ –ø–æ–∫–∞–∑—É –º–æ–∂–ª–∏–≤–æ—Å—Ç–µ–π –ø—Ä–æ–≥—Ä–∞–º–∏.
 *
 * –¢–µ—Å—Ç–æ–≤—ñ –¥–∞–Ω—ñ:
 * - Email: ivan.petrenko@gmail.com.
 * - –Ü–º'—è: –Ü–≤–∞–Ω.
 * - –ü—Ä—ñ–∑–≤–∏—â–µ: –ü–µ—Ç—Ä–µ–Ω–∫–æ.
 * - –î–∞—Ç–∞ –Ω–∞—Ä–æ–¥–∂–µ–Ω–Ω—è: 15.03.1995.
 */
void EmailEncryptorWindow::fillKeyExample() {
    key_emailEdit->setText("ivan.petrenko@gmail.com");
    key_firstNameEdit->setText("–Ü–≤–∞–Ω");
    key_lastNameEdit->setText("–ü–µ—Ç—Ä–µ–Ω–∫–æ");
    key_birthDateEdit->setDate(QDate(1995, 3, 15));
}

/**
 * @brief –ó–±–µ—Ä–µ–∂–µ–Ω–Ω—è –∑–≥–µ–Ω–µ—Ä–æ–≤–∞–Ω–æ–≥–æ –∫–ª—é—á–∞ —É —Ç–µ–∫—Å—Ç–æ–≤–∏–π —Ñ–∞–π–ª.
 *
 * –ü—Ä–æ—Ü–µ—Å –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è:
 * 1. –ü–µ—Ä–µ–≤—ñ—Ä—è—î, —á–∏ —î –∑–≥–µ–Ω–µ—Ä–æ–≤–∞–Ω–∏–π –∫–ª—é—á.
 * 2. –í—ñ–¥–∫—Ä–∏–≤–∞—î –¥—ñ–∞–ª–æ–≥ –≤–∏–±–æ—Ä—É –º—ñ—Å—Ü—è –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è.
 * 3. –ü—Ä–æ–ø–æ–Ω—É—î –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–µ —ñ–º'—è —Ñ–∞–π–ª—É –Ω–∞ –æ—Å–Ω–æ–≤—ñ email.
 * 4. –ó–±–µ—Ä—ñ–≥–∞—î —Ç—ñ–ª—å–∫–∏ hex-–∫–ª—é—á (–±–µ–∑ —Ñ–æ—Ä–º–∞—Ç—É–≤–∞–Ω–Ω—è).
 * 5. –ü–æ–∫–∞–∑—É—î –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –ø—Ä–æ —É—Å–ø—ñ—Ö.
 *
 * –§–æ—Ä–º–∞—Ç —Ñ–∞–π–ª—É: plain text, –æ–¥–Ω–∞ —Å—Ç—Ä–æ–∫–∞ –∑ hex-–∫–ª—é—á–µ–º.
 * –ü—Ä–∏–∫–ª–∞–¥ —ñ–º–µ–Ω—ñ: ivan_petrenko_gmail_com_key.txt.
 */
void EmailEncryptorWindow::saveKey() {
    // ========== –ö–†–û–ö 1: –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –Ω–∞—è–≤–Ω–æ—Å—Ç—ñ –∫–ª—é—á–∞ ==========

    if (currentKey.keyHex.isEmpty()) {
        QMessageBox::warning(this, "–ü–æ–º–∏–ª–∫–∞", "–°–ø–æ—á–∞—Ç–∫—É –∑–≥–µ–Ω–µ—Ä—É–π—Ç–µ –∫–ª—é—á!");
        return;
    }

    // ========== –ö–†–û–ö 2: –î—ñ–∞–ª–æ–≥ –≤–∏–±–æ—Ä—É –º—ñ—Å—Ü—è –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è ==========

    // –ì–µ–Ω–µ—Ä—É—î–º–æ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–µ —ñ–º'—è —Ñ–∞–π–ª—É –∑ email.
    // –ó–∞–º—ñ–Ω—é—î–º–æ —Å–ø–µ—Ü—Å–∏–º–≤–æ–ª–∏ @ —Ç–∞ . –Ω–∞ _ –¥–ª—è –∫–æ—Ä–µ–∫—Ç–Ω–æ–≥–æ —ñ–º–µ–Ω—ñ —Ñ–∞–π–ª—É.
    QString defaultFileName = currentKey.email
                                  .replace("@", "_")
                                  .replace(".", "_")
                              + "_key.txt";

    // –í—ñ–¥–∫—Ä–∏–≤–∞—î–º–æ –¥—ñ–∞–ª–æ–≥ –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è —Ñ–∞–π–ª—É.
    QString fileName = QFileDialog::getSaveFileName(
        this,
        "–ó–±–µ—Ä–µ–≥—Ç–∏ –∫–ª—é—á —à–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è",    // –ó–∞–≥–æ–ª–æ–≤–æ–∫ –¥—ñ–∞–ª–æ–≥—É.
        defaultFileName,                // –ó–∞–ø—Ä–æ–ø–æ–Ω–æ–≤–∞–Ω–µ —ñ–º'—è.
        "Text Files (*.txt);;All Files (*)"  // –§—ñ–ª—å—Ç—Ä–∏ —Ç–∏–ø—ñ–≤ —Ñ–∞–π–ª—ñ–≤.
        );

    // –Ø–∫—â–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á —Å–∫–∞—Å—É–≤–∞–≤ –¥—ñ–∞–ª–æ–≥ (–Ω–µ –≤–∏–±—Ä–∞–≤ —Ñ–∞–π–ª).
    if (fileName.isEmpty()) {
        return;
    }

    // ========== –ö–†–û–ö 3: –í—ñ–¥–∫—Ä–∏—Ç—Ç—è —Ñ–∞–π–ª—É –¥–ª—è –∑–∞–ø–∏—Å—É ==========

    QFile file(fileName);
    // –í—ñ–¥–∫—Ä–∏–≤–∞—î–º–æ —Ñ–∞–π–ª —É —Ä–µ–∂–∏–º—ñ –∑–∞–ø–∏—Å—É (WriteOnly) —è–∫ —Ç–µ–∫—Å—Ç.
    if (!file.open(QIODevice::WriteOnly | QIODevice::Text)) {
        QMessageBox::critical(this, "–ü–æ–º–∏–ª–∫–∞", "–ù–µ –≤–¥–∞–ª–æ—Å—è –∑–±–µ—Ä–µ–≥—Ç–∏ —Ñ–∞–π–ª!");
        return;
    }

    // ========== –ö–†–û–ö 4: –ó–∞–ø–∏—Å –∫–ª—é—á–∞ —É —Ñ–∞–π–ª ==========

    // –°—Ç–≤–æ—Ä—é—î–º–æ —Ç–µ–∫—Å—Ç–æ–≤–∏–π –ø–æ—Ç—ñ–∫ –¥–ª—è –∑—Ä—É—á–Ω–æ–≥–æ –∑–∞–ø–∏—Å—É.
    QTextStream out(&file);
    // –ó–∞–ø–∏—Å—É—î–º–æ hex-–∫–ª—é—á (–±–µ–∑ —Ñ–æ—Ä–º–∞—Ç—É–≤–∞–Ω–Ω—è —Ç–∞ –º–µ—Ç–∞–¥–∞–Ω–∏—Ö).
    out << currentKey.keyHex;
    file.close();

    // ========== –ö–†–û–ö 5: –ü–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –ø—Ä–æ —É—Å–ø—ñ—Ö ==========

    QMessageBox::information(
        this,
        "–£—Å–ø—ñ—Ö",
        QString("–ö–ª—é—á —à–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è –∑–±–µ—Ä–µ–∂–µ–Ω–æ —É —Ñ–∞–π–ª:\n%1\n\n"
                "–ó–±–µ—Ä—ñ–≥–∞–π—Ç–µ —Ü–µ–π —Ñ–∞–π–ª –≤ –±–µ–∑–ø–µ—á–Ω–æ–º—É –º—ñ—Å—Ü—ñ!").arg(fileName)
        );
}

/**
 * @brief –û—á–∏—â–µ–Ω–Ω—è –≤—Å—ñ—Ö –ø–æ–ª—ñ–≤ –≤–∫–ª–∞–¥–∫–∏ –≥–µ–Ω–µ—Ä–∞—Ü—ñ—ó –∫–ª—é—á–∞.
 *
 * –°–∫–∏–¥–∞—î –≤—Å—ñ –ø–æ–ª—è –¥–æ –ø–æ—á–∞—Ç–∫–æ–≤–æ–≥–æ —Å—Ç–∞–Ω—É:
 * - –û—á–∏—â–∞—î —Ç–µ–∫—Å—Ç–æ–≤—ñ –ø–æ–ª—è (email, —ñ–º'—è, –ø—Ä—ñ–∑–≤–∏—â–µ).
 * - –í—Å—Ç–∞–Ω–æ–≤–ª—é—î –¥–∞—Ç—É –∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º (01.01.1995).
 * - –û—á–∏—â–∞—î –ø–æ–ª–µ –∑–≥–µ–Ω–µ—Ä–æ–≤–∞–Ω–æ–≥–æ –∫–ª—é—á–∞.
 * - –û—á–∏—â–∞—î —Å—Ç—Ä—É–∫—Ç—É—Ä—É currentKey.
 * - –î–µ–∞–∫—Ç–∏–≤—É—î –∫–Ω–æ–ø–∫—É "–ó–±–µ—Ä–µ–≥—Ç–∏ –∫–ª—é—á".
 */
void EmailEncryptorWindow::clearKeyTab() {
    // –û—á–∏—â–µ–Ω–Ω—è —Ç–µ–∫—Å—Ç–æ–≤–∏—Ö –ø–æ–ª—ñ–≤.
    key_emailEdit->clear();
    key_firstNameEdit->clear();
    key_lastNameEdit->clear();

    // –í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è –¥–∞—Ç–∏ –∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º.
    key_birthDateEdit->setDate(QDate(1995, 1, 1));

    // –û—á–∏—â–µ–Ω–Ω—è –ø–æ–ª—è –∫–ª—é—á–∞.
    key_generatedKeyEdit->clear();

    // –°–∫–∏–¥–∞–Ω–Ω—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∏ –∫–ª—é—á–∞ –¥–æ –ø–æ—Ä–æ–∂–Ω—å–æ–≥–æ —Å—Ç–∞–Ω—É.
    currentKey = EncryptionKey();

    // –î–µ–∞–∫—Ç–∏–≤–∞—Ü—ñ—è –∫–Ω–æ–ø–∫–∏ –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è (–±–æ –∫–ª—é—á–∞ –±—ñ–ª—å—à–µ –Ω–µ–º–∞—î).
    key_saveBtn->setEnabled(false);
}

/*
 * ============================================================================
 * –û–ë–†–û–ë–ù–ò–ö–ò –í–ö–õ–ê–î–ö–ò –®–ò–§–†–£–í–ê–ù–ù–Ø
 * ============================================================================
 */

/**
 * @brief –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –∫–ª—é—á–∞ —à–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è –∑ —Ñ–∞–π–ª—É.
 *
 * –ü—Ä–æ—Ü–µ—Å –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è:
 * 1. –í—ñ–¥–∫—Ä–∏–≤–∞—î –¥—ñ–∞–ª–æ–≥ –≤–∏–±–æ—Ä—É —Ñ–∞–π–ª—É –∫–ª—é—á–∞.
 * 2. –ß–∏—Ç–∞—î –≤–º—ñ—Å—Ç —Ñ–∞–π–ª—É (hex-–∫–ª—é—á).
 * 3. –ó–±–µ—Ä—ñ–≥–∞—î –∫–ª—é—á —É –∑–º—ñ–Ω–Ω—É encryptionKey.
 * 4. –í—ñ–¥–æ–±—Ä–∞–∂–∞—î —à–ª—è—Ö –¥–æ —Ñ–∞–π–ª—É —É –ø–æ–ª—ñ.
 * 5. –ü–æ–∫–∞–∑—É—î –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –ø—Ä–æ —É—Å–ø—ñ—Ö.
 *
 * –§–æ—Ä–º–∞—Ç —Ñ–∞–π–ª—É: plain text –∑ hex-–∫–ª—é—á–µ–º (64 —Å–∏–º–≤–æ–ª–∏).
 */
void EmailEncryptorWindow::loadEncryptionKey() {
    // ========== –ö–†–û–ö 1: –î—ñ–∞–ª–æ–≥ –≤–∏–±–æ—Ä—É —Ñ–∞–π–ª—É –∫–ª—é—á–∞ ==========

    QString fileName = QFileDialog::getOpenFileName(
        this,
        "–ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ –∫–ª—é—á —à–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è",  // –ó–∞–≥–æ–ª–æ–≤–æ–∫ –¥—ñ–∞–ª–æ–≥—É.
        "",                              // –ü–æ—á–∞—Ç–∫–æ–≤–∞ –¥–∏—Ä–µ–∫—Ç–æ—Ä—ñ—è.
        "Text Files (*.txt);;All Files (*)"  // –§—ñ–ª—å—Ç—Ä–∏ —Ñ–∞–π–ª—ñ–≤.
        );

    // –Ø–∫—â–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á —Å–∫–∞—Å—É–≤–∞–≤ –¥—ñ–∞–ª–æ–≥.
    if (fileName.isEmpty()) {
        return;
    }

    // ========== –ö–†–û–ö 2: –ß–∏—Ç–∞–Ω–Ω—è —Ñ–∞–π–ª—É ==========

    QFile file(fileName);
    // –í—ñ–¥–∫—Ä–∏–≤–∞—î–º–æ —Ñ–∞–π–ª —É —Ä–µ–∂–∏–º—ñ —á–∏—Ç–∞–Ω–Ω—è —è–∫ —Ç–µ–∫—Å—Ç.
    if (!file.open(QIODevice::ReadOnly | QIODevice::Text)) {
        QMessageBox::critical(this, "–ü–æ–º–∏–ª–∫–∞", "–ù–µ –≤–¥–∞–ª–æ—Å—è –≤—ñ–¥–∫—Ä–∏—Ç–∏ —Ñ–∞–π–ª!");
        return;
    }

    // –°—Ç–≤–æ—Ä—é—î–º–æ —Ç–µ–∫—Å—Ç–æ–≤–∏–π –ø–æ—Ç—ñ–∫ –¥–ª—è —á–∏—Ç–∞–Ω–Ω—è.
    QTextStream in(&file);
    // –ß–∏—Ç–∞—î–º–æ –≤–µ—Å—å –≤–º—ñ—Å—Ç —Ñ–∞–π–ª—É —Ç–∞ –≤–∏–¥–∞–ª—è—î–º–æ –∑–∞–π–≤—ñ –ø—Ä–æ–±—ñ–ª–∏.
    encryptionKey = in.readAll().trimmed();
    file.close();

    // ========== –ö–†–û–ö 3: –í—ñ–¥–æ–±—Ä–∞–∂–µ–Ω–Ω—è —à–ª—è—Ö—É –¥–æ —Ñ–∞–π–ª—É ==========

    // –ü–æ–∫–∞–∑—É—î–º–æ —à–ª—è—Ö —É —Ç–µ–∫—Å—Ç–æ–≤–æ–º—É –ø–æ–ª—ñ (–¥–ª—è —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞).
    encrypt_keyPathEdit->setText(fileName);

    // ========== –ö–†–û–ö 4: –ü–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –ø—Ä–æ —É—Å–ø—ñ—Ö ==========

    QMessageBox::information(
        this,
        "–£—Å–ø—ñ—Ö",
        "–ö–ª—é—á —à–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è —É—Å–ø—ñ—à–Ω–æ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–æ!"
        );

    // –ù–∞–ª–∞–≥–æ–¥–∂—É–≤–∞–ª—å–Ω–∞ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è (–≤–∏–≤–æ–¥–∏—Ç—å—Å—è –≤ –∫–æ–Ω—Å–æ–ª—å).
    qDebug() << "Encryption key loaded from:" << fileName;
    qDebug() << "Key:" << encryptionKey;
}

/**
 * @brief –®–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è —Ç–µ–∫—Å—Ç–æ–≤–æ–≥–æ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è.
 *
 * –ê–ª–≥–æ—Ä–∏—Ç–º —Ä–æ–±–æ—Ç–∏:
 * 1. –ü–µ—Ä–µ–≤—ñ—Ä—è—î –Ω–∞—è–≤–Ω—ñ—Å—Ç—å –∫–ª—é—á–∞ —Ç–∞ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è.
 * 2. –í–∏–∫–ª–∏–∫–∞—î –¥–≤–∏–∂–æ–∫ —à–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è (XOR + Base64).
 * 3. –§–æ—Ä–º–∞—Ç—É—î —Ä–µ–∑—É–ª—å—Ç–∞—Ç –¥–ª—è –≤—ñ–¥–æ–±—Ä–∞–∂–µ–Ω–Ω—è.
 * 4. –í–∏–≤–æ–¥–∏—Ç—å –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–µ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è.
 * 5. –ê–∫—Ç–∏–≤—É—î –∫–Ω–æ–ø–∫—É –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è.
 *
 * –ü—Ä–æ—Ü–µ—Å —à–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è (–≤ EncryptionEngine):
 * - –ü–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è ‚Üí UTF-8 –±–∞–π—Ç–∏.
 * - –ö–ª—é—á (hex) ‚Üí –±–∞–π—Ç–∏.
 * - XOR –±–∞–π—Ç-–ø–æ-–±–∞–π—Ç—É.
 * - –†–µ–∑—É–ª—å—Ç–∞—Ç ‚Üí Base64 –∫–æ–¥—É–≤–∞–Ω–Ω—è.
 */
void EmailEncryptorWindow::encryptMessage() {
    // ========== –ö–†–û–ö 1: –í–∞–ª—ñ–¥–∞—Ü—ñ—è –≤—Ö—ñ–¥–Ω–∏—Ö –¥–∞–Ω–∏—Ö ==========

    // –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –Ω–∞—è–≤–Ω–æ—Å—Ç—ñ –∫–ª—é—á–∞.
    if (encryptionKey.isEmpty()) {
        QMessageBox::warning(
            this,
            "–ü–æ–º–∏–ª–∫–∞",
            "–°–ø–æ—á–∞—Ç–∫—É –∑–∞–≤–∞–Ω—Ç–∞–∂—Ç–µ –∫–ª—é—á —à–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è!"
            );
        return;
    }

    // –ó—á–∏—Ç—É–≤–∞–Ω–Ω—è –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –∑ —Ç–µ–∫—Å—Ç–æ–≤–æ–≥–æ –ø–æ–ª—è.
    QString message = encrypt_messageEdit->toPlainText().trimmed();

    // –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –Ω–∞—è–≤–Ω–æ—Å—Ç—ñ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è.
    if (message.isEmpty()) {
        QMessageBox::warning(
            this,
            "–ü–æ–º–∏–ª–∫–∞",
            "–í–≤–µ–¥—ñ—Ç—å –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –¥–ª—è —à–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è!"
            );
        return;
    }

    // ========== –ö–†–û–ö 2: –í–∏–∫–ª–∏–∫ –¥–≤–∏–∂–∫–∞ —à–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è ==========

    // –î–≤–∏–∂–æ–∫ –≤–∏–∫–æ–Ω—É—î:
    // 1. message.toUtf8() - –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü—ñ—è —Ç–µ–∫—Å—Ç—É –≤ –±–∞–π—Ç–∏.
    // 2. key.fromHex() - –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü—ñ—è hex-–∫–ª—é—á–∞ –≤ –±–∞–π—Ç–∏.
    // 3. XOR - –ø–æ–±–∞–π—Ç–æ–≤–µ —à–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è.
    // 4. toBase64() - –∫–æ–¥—É–≤–∞–Ω–Ω—è –¥–ª—è —Ç–µ–∫—Å—Ç–æ–≤–æ—ó –ø–µ—Ä–µ–¥–∞—á—ñ.
    QString encrypted = encryptionEngine->encryptMessage(message, encryptionKey);

    // ========== –ö–†–û–ö 3: –§–æ—Ä–º–∞—Ç—É–≤–∞–Ω–Ω—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç—É ==========

    // –°—Ç–≤–æ—Ä—é—î–º–æ —ñ–Ω—Ñ–æ—Ä–º–∞—Ç–∏–≤–Ω–∏–π –≤–∏–≤—ñ–¥ –∑ –º–µ—Ç–∞–¥–∞–Ω–∏–º–∏
    QString resultFormatted = QString(
                                  "üîê –ó–ê–®–ò–§–†–û–í–ê–ù–ï –ü–û–í–Ü–î–û–ú–õ–ï–ù–ù–Ø\n"
                                  "‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\n\n"
                                  "–§–æ—Ä–º–∞—Ç: Base64\n"
                                  "–ê–ª–≥–æ—Ä–∏—Ç–º: XOR + SHA-256\n\n"
                                  "–ó–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω—ñ –¥–∞–Ω—ñ:\n%1\n\n"        // –ü—ñ–¥—Å—Ç–∞–≤–ª—è—î–º–æ —à–∏—Ñ—Ä–æ—Ç–µ–∫—Å—Ç
                                  "–î–æ–≤–∂–∏–Ω–∞: %2 —Å–∏–º–≤–æ–ª—ñ–≤\n\n"         // –î–æ–≤–∂–∏–Ω–∞ Base64 —Ä—è–¥–∫–∞
                                  "–¶–µ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –º–æ–∂–Ω–∞ –±–µ–∑–ø–µ—á–Ω–æ –ø–µ—Ä–µ–¥–∞–≤–∞—Ç–∏ —ñ–Ω—à–∏–º.\n"
                                  "–î–ª—è —Ä–æ–∑—à–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è –ø–æ—Ç—Ä—ñ–±–µ–Ω —Ç–æ–π —Å–∞–º–∏–π –∫–ª—é—á."
                                  ).arg(encrypted)                       // %1 - –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–µ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è
                                  .arg(encrypted.length());             // %2 - –¥–æ–≤–∂–∏–Ω–∞

    // –í–∏–≤–æ–¥–∏–º–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç —É –ø–æ–ª–µ
    encrypt_encryptedEdit->setPlainText(resultFormatted);

    // ========== –ö–†–û–ö 4: –ü–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –ø—Ä–æ —É—Å–ø—ñ—Ö ==========

    QMessageBox::information(
        this,
        "–£—Å–ø—ñ—Ö",
        "–ü–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è —É—Å–ø—ñ—à–Ω–æ –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–æ!\n\n"
        "–¢–µ–ø–µ—Ä –≤–∏ –º–æ–∂–µ—Ç–µ —Å–∫–æ–ø—ñ—é–≤–∞—Ç–∏ –∞–±–æ –∑–±–µ—Ä–µ–≥—Ç–∏ –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–µ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è "
        "–¥–ª—è –ø–µ—Ä–µ–¥–∞—á—ñ —ñ–Ω—à—ñ–π —Å—Ç–æ—Ä–æ–Ω—ñ."
        );

    // –ù–∞–ª–∞–≥–æ–¥–∂—É–≤–∞–ª—å–Ω–∞ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è
    qDebug() << "Message encrypted successfully";
}

/**
 * @brief –í–∏–±—ñ—Ä —Ñ–∞–π–ª—É –¥–ª—è —à–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è.
 *
 * –ü—Ä–æ—Ü–µ—Å –≤–∏–±–æ—Ä—É:
 * 1. –í—ñ–¥–∫—Ä–∏–≤–∞—î –¥—ñ–∞–ª–æ–≥ –≤–∏–±–æ—Ä—É —Ñ–∞–π–ª—É (–±—É–¥—å-—è–∫–æ–≥–æ —Ç–∏–ø—É).
 * 2. –ó–∞–≤–∞–Ω—Ç–∞–∂—É—î –≤–µ—Å—å —Ñ–∞–π–ª —É –ø–∞–º'—è—Ç—å (–±–∞–π—Ç–∏).
 * 3. –ó–±–µ—Ä—ñ–≥–∞—î —à–ª—è—Ö –¥–æ —Ñ–∞–π–ª—É —Ç–∞ –π–æ–≥–æ –¥–∞–Ω—ñ.
 * 4. –í—ñ–¥–æ–±—Ä–∞–∂–∞—î —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é –ø—Ä–æ —Ñ–∞–π–ª (—ñ–º'—è, —Ä–æ–∑–º—ñ—Ä).
 */
void EmailEncryptorWindow::selectFileToEncrypt() {
    // ========== –ö–†–û–ö 1: –î—ñ–∞–ª–æ–≥ –≤–∏–±–æ—Ä—É —Ñ–∞–π–ª—É ==========

    QString fileName = QFileDialog::getOpenFileName(
        this,
        "–í–∏–±–µ—Ä—ñ—Ç—å —Ñ–∞–π–ª –¥–ª—è —à–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è",
        "",                      // –ü–æ—á–∞—Ç–∫–æ–≤–∞ –¥–∏—Ä–µ–∫—Ç–æ—Ä—ñ—è.
        "All Files (*)"          // –î–æ–∑–≤–æ–ª—è—î–º–æ –≤–∏–±—Ä–∞—Ç–∏ –±—É–¥—å-—è–∫–∏–π —Ñ–∞–π–ª.
        );

    if (fileName.isEmpty()) {
        return;
    }

    // ========== –ö–†–û–ö 2: –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —Ñ–∞–π–ª—É ==========

    QFile file(fileName);
    // –í—ñ–¥–∫—Ä–∏–≤–∞—î–º–æ —Ñ–∞–π–ª —É –±—ñ–Ω–∞—Ä–Ω–æ–º—É —Ä–µ–∂–∏–º—ñ (ReadOnly –±–µ–∑ Text).
    if (!file.open(QIODevice::ReadOnly)) {
        QMessageBox::critical(this, "–ü–æ–º–∏–ª–∫–∞", "–ù–µ –≤–¥–∞–ª–æ—Å—è –≤—ñ–¥–∫—Ä–∏—Ç–∏ —Ñ–∞–π–ª!");
        return;
    }

    // –ß–∏—Ç–∞—î–º–æ –≤–µ—Å—å —Ñ–∞–π–ª —É –º–∞—Å–∏–≤ –±–∞–π—Ç—ñ–≤.
    encryptFileData = file.readAll();
    file.close();

    // ========== –ö–†–û–ö 3: –ó–±–µ—Ä–µ–∂–µ–Ω–Ω—è –º–µ—Ç–∞–¥–∞–Ω–∏—Ö ==========

    // –ó–±–µ—Ä—ñ–≥–∞—î–º–æ —à–ª—è—Ö –¥–ª—è –ø–æ–¥–∞–ª—å—à–æ–≥–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è.
    encryptFilePath = fileName;

    // –í—ñ–¥–æ–±—Ä–∞–∂–∞—î–º–æ —à–ª—è—Ö —É –ø–æ–ª—ñ (–¥–ª—è —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞).
    encrypt_filePathEdit->setText(fileName);

    // ========== –ö–†–û–ö 4: –í—ñ–¥–æ–±—Ä–∞–∂–µ–Ω–Ω—è —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó –ø—Ä–æ —Ñ–∞–π–ª ==========

    // –û—Ç—Ä–∏–º—É—î–º–æ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é –ø—Ä–æ —Ñ–∞–π–ª (—ñ–º'—è, —Ä–æ–∑–º—ñ—Ä, —Ç–æ—â–æ).
    QFileInfo fileInfo(fileName);

    // –§–æ—Ä–º–∞—Ç—É—î–º–æ —Ç–∞ –≤–∏–≤–æ–¥–∏–º–æ: "document.pdf (123456 –±–∞–π—Ç)".
    encrypt_fileInfoLabel->setText(
        QString("üìÑ %1 (%2 –±–∞–π—Ç)")
            .arg(fileInfo.fileName())          // –Ü–º'—è —Ñ–∞–π–ª—É.
            .arg(encryptFileData.size())       // –†–æ–∑–º—ñ—Ä —É –±–∞–π—Ç–∞—Ö.
        );

    // –ù–∞–ª–∞–≥–æ–¥–∂—É–≤–∞–ª—å–Ω–∞ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è.
    qDebug() << "File selected for encryption:" << fileName;
    qDebug() << "File size:" << encryptFileData.size() << "bytes";
}

/**
 * @brief –®–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è —Ñ–∞–π–ª—É —Ç–∞ –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç—É.
 *
 * –ê–ª–≥–æ—Ä–∏—Ç–º —Ä–æ–±–æ—Ç–∏:
 * 1. –ü–µ—Ä–µ–≤—ñ—Ä—è—î –Ω–∞—è–≤–Ω—ñ—Å—Ç—å –∫–ª—é—á–∞ —Ç–∞ —Ñ–∞–π–ª—É.
 * 2. –í–∏–∫–ª–∏–∫–∞—î –¥–≤–∏–∂–æ–∫ —à–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è (XOR –±–∞–π—Ç-–ø–æ-–±–∞–π—Ç—É).
 * 3. –ü—Ä–æ–ø–æ–Ω—É—î –∑–±–µ—Ä–µ–≥—Ç–∏ –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–π —Ñ–∞–π–ª –∑ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è–º .encrypted.
 * 4. –ó–±–µ—Ä—ñ–≥–∞—î –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω—ñ –±–∞–π—Ç–∏ —É —Ñ–∞–π–ª.
 * 5. –ü–æ–∫–∞–∑—É—î —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É (—Ä–æ–∑–º—ñ—Ä–∏ —Ñ–∞–π–ª—ñ–≤).
 *
 * –ü—Ä–æ—Ü–µ—Å —à–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è —Ñ–∞–π–ª—É:
 * - –ë–∞–π—Ç–∏ —Ñ–∞–π–ª—É ‚Üí XOR –∑ –∫–ª—é—á–µ–º ‚Üí –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω—ñ –±–∞–π—Ç–∏.
 * - –†–æ–∑–º—ñ—Ä –∑–∞–ª–∏—à–∞—î—Ç—å—Å—è –Ω–µ–∑–º—ñ–Ω–Ω–∏–º!.
 * - –ü—Ä–∞—Ü—é—î –∑ –±—É–¥—å-—è–∫–∏–º —Ç–∏–ø–æ–º —Ñ–∞–π–ª—ñ–≤ (PDF, JPG, EXE, —Ç–æ—â–æ).
 */
void EmailEncryptorWindow::encryptFile() {
    // ========== –ö–†–û–ö 1: –í–∞–ª—ñ–¥–∞—Ü—ñ—è –≤—Ö—ñ–¥–Ω–∏—Ö –¥–∞–Ω–∏—Ö ==========

    // –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –∫–ª—é—á–∞.
    if (encryptionKey.isEmpty()) {
        QMessageBox::warning(
            this,
            "–ü–æ–º–∏–ª–∫–∞",
            "–°–ø–æ—á–∞—Ç–∫—É –∑–∞–≤–∞–Ω—Ç–∞–∂—Ç–µ –∫–ª—é—á —à–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è!"
            );
        return;
    }

    // –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –Ω–∞—è–≤–Ω–æ—Å—Ç—ñ —Ñ–∞–π–ª—É.
    if (encryptFileData.isEmpty()) {
        QMessageBox::warning(this, "–ü–æ–º–∏–ª–∫–∞", "–°–ø–æ—á–∞—Ç–∫—É –≤–∏–±–µ—Ä—ñ—Ç—å —Ñ–∞–π–ª!");
        return;
    }

    // ========== –ö–†–û–ö 2: –®–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è —Ñ–∞–π–ª—É ==========

    // –î–≤–∏–∂–æ–∫ –≤–∏–∫–æ–Ω—É—î:
    // 1. –ö–æ–Ω–≤–µ—Ä—Ç—É—î hex-–∫–ª—é—á —É –±–∞–π—Ç–∏.
    // 2. –¶–∏–∫–ª—ñ—á–Ω–æ –ø–æ–≤—Ç–æ—Ä—é—î –∫–ª—é—á –¥–æ –¥–æ–≤–∂–∏–Ω–∏ —Ñ–∞–π–ª—É.
    // 3. –í–∏–∫–æ–Ω—É—î XOR –¥–ª—è –∫–æ–∂–Ω–æ–≥–æ –±–∞–π—Ç–∞: result[i] = file[i] ^ key[i].
    QByteArray encrypted = encryptionEngine->encryptFile(
        encryptFileData,      // –û—Ä–∏–≥—ñ–Ω–∞–ª—å–Ω—ñ –±–∞–π—Ç–∏ —Ñ–∞–π–ª—É
        encryptionKey         // Hex-–∫–ª—é—á
        );

    // ========== –ö–†–û–ö 3: –î—ñ–∞–ª–æ–≥ –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–æ–≥–æ —Ñ–∞–π–ª—É ==========

    // –ü—Ä–æ–ø–æ–Ω—É—î–º–æ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–µ —ñ–º'—è: original.pdf ‚Üí original.pdf.encrypted.
    QString saveFileName = QFileDialog::getSaveFileName(
        this,
        "–ó–±–µ—Ä–µ–≥—Ç–∏ –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–π —Ñ–∞–π–ª",
        encryptFilePath + ".encrypted",  // –î–æ–¥–∞—î–º–æ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è .encrypted.
        "Encrypted Files (*.encrypted);;All Files (*)"
        );

    if (saveFileName.isEmpty()) {
        return;  // –ö–æ—Ä–∏—Å—Ç—É–≤–∞—á —Å–∫–∞—Å—É–≤–∞–≤ –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è.
    }

    // ========== –ö–†–û–ö 4: –ó–±–µ—Ä–µ–∂–µ–Ω–Ω—è –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–æ–≥–æ —Ñ–∞–π–ª—É ==========

    QFile file(saveFileName);
    // –í—ñ–¥–∫—Ä–∏–≤–∞—î–º–æ —É –±—ñ–Ω–∞—Ä–Ω–æ–º—É —Ä–µ–∂–∏–º—ñ –¥–ª—è –∑–∞–ø–∏—Å—É.
    if (!file.open(QIODevice::WriteOnly)) {
        QMessageBox::critical(this, "–ü–æ–º–∏–ª–∫–∞", "–ù–µ –≤–¥–∞–ª–æ—Å—è –∑–±–µ—Ä–µ–≥—Ç–∏ —Ñ–∞–π–ª!");
        return;
    }

    // –ó–∞–ø–∏—Å—É—î–º–æ –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω—ñ –±–∞–π—Ç–∏.
    file.write(encrypted);
    file.close();

    // ========== –ö–†–û–ö 5: –ü–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –ø—Ä–æ —É—Å–ø—ñ—Ö –∑ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–æ—é ==========

    QMessageBox::information(
        this,
        "–£—Å–ø—ñ—Ö",
        QString(
            "–§–∞–π–ª —É—Å–ø—ñ—à–Ω–æ –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–æ!\n\n"
            "–û—Ä–∏–≥—ñ–Ω–∞–ª—å–Ω–∏–π —Ñ–∞–π–ª: %1 (%2 –±–∞–π—Ç)\n"
            "–ó–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–π —Ñ–∞–π–ª: %3 (%4 –±–∞–π—Ç)\n\n"
            "–ó–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–π —Ñ–∞–π–ª –º–æ–∂–Ω–∞ –±–µ–∑–ø–µ—á–Ω–æ –ø–µ—Ä–µ–¥–∞–≤–∞—Ç–∏ —ñ–Ω—à–∏–º."
            ).arg(QFileInfo(encryptFilePath).fileName())    // –Ü–º'—è –æ—Ä–∏–≥—ñ–Ω–∞–ª—É.
            .arg(encryptFileData.size())                   // –†–æ–∑–º—ñ—Ä –æ—Ä–∏–≥—ñ–Ω–∞–ª—É.
            .arg(QFileInfo(saveFileName).fileName())       // –Ü–º'—è –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–æ–≥–æ.
            .arg(encrypted.size())                         // –†–æ–∑–º—ñ—Ä –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–æ–≥–æ.
        );

    // –ù–∞–ª–∞–≥–æ–¥–∂—É–≤–∞–ª—å–Ω–∞ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è
    qDebug() << "File encrypted and saved to:" << saveFileName;
}

/**
 * @brief –ó–±–µ—Ä–µ–∂–µ–Ω–Ω—è –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–æ–≥–æ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è —É —Ñ–∞–π–ª.
 *
 * –ü—Ä–æ—Ü–µ—Å –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è:
 * 1. –ü–µ—Ä–µ–≤—ñ—Ä—è—î –Ω–∞—è–≤–Ω—ñ—Å—Ç—å –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–æ–≥–æ —Ç–µ–∫—Å—Ç—É.
 * 2. –í–∏—Ç—è–≥—É—î —á–∏—Å—Ç–∏–π Base64 (–±–µ–∑ —Ñ–æ—Ä–º–∞—Ç—É–≤–∞–Ω–Ω—è).
 * 3. –ü—Ä–æ–ø–æ–Ω—É—î –∑–±–µ—Ä–µ–≥—Ç–∏ —É —Ñ–∞–π–ª .txt.
 * 4. –ó–±–µ—Ä—ñ–≥–∞—î —Ç—ñ–ª—å–∫–∏ Base64 —Ä—è–¥–æ–∫.
 *
 * –í–∏—Ç—è–≥–Ω–µ–Ω–Ω—è –¥–∞–Ω–∏—Ö:
 * - –®—É–∫–∞—î –º–∞—Ä–∫–µ—Ä "–ó–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω—ñ –¥–∞–Ω—ñ:\n".
 * - –ë–µ—Ä–µ —Ç–µ–∫—Å—Ç –¥–æ –º–∞—Ä–∫–µ—Ä–∞ "\n\n–î–æ–≤–∂–∏–Ω–∞:".
 * - –¶–µ –¥–æ–∑–≤–æ–ª—è—î –∑–±–µ—Ä–µ–≥—Ç–∏ —á–∏—Å—Ç–∏–π Base64 –±–µ–∑ –æ–ø–∏—Å—É.
 */
void EmailEncryptorWindow::saveEncryptedMessage() {
    // ========== –ö–†–û–ö 1: –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –Ω–∞—è–≤–Ω–æ—Å—Ç—ñ —Ç–µ–∫—Å—Ç—É ==========

    QString text = encrypt_encryptedEdit->toPlainText();
    if (text.isEmpty()) {
        QMessageBox::warning(this, "–ü–æ–º–∏–ª–∫–∞", "–ù–µ–º–∞—î –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–æ–≥–æ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è!");
        return;
    }

    // ========== –ö–†–û–ö 2: –í–∏—Ç—è–≥–Ω–µ–Ω–Ω—è —á–∏—Å—Ç–æ–≥–æ Base64 ==========

    // –®—É–∫–∞—î–º–æ –ø–æ—á–∞—Ç–æ–∫ –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—Ö –¥–∞–Ω–∏—Ö.
    int startIndex = text.indexOf("–ó–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω—ñ –¥–∞–Ω—ñ:\n");
    if (startIndex != -1) {
        // –ó–º—ñ—â—É—î–º–æ—Å—å –¥–æ –ø–æ—á–∞—Ç–∫—É Base64 —Ä—è–¥–∫–∞.
        startIndex += QString("–ó–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω—ñ –¥–∞–Ω—ñ:\n").length();

        // –®—É–∫–∞—î–º–æ –∫—ñ–Ω–µ—Ü—å Base64 (–ø–µ—Ä–µ–¥ "\n\n–î–æ–≤–∂–∏–Ω–∞:").
        int endIndex = text.indexOf("\n\n–î–æ–≤–∂–∏–Ω–∞:");
        if (endIndex != -1) {
            // –í–∏—Ç—è–≥—É—î–º–æ –ø—ñ–¥—Ä—è–¥–æ–∫ –º—ñ–∂ –º–∞—Ä–∫–µ—Ä–∞–º–∏.
            text = text.mid(startIndex, endIndex - startIndex).trimmed();
        }
    }

    // ========== –ö–†–û–ö 3: –î—ñ–∞–ª–æ–≥ –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è ==========

    QString fileName = QFileDialog::getSaveFileName(
        this,
        "–ó–±–µ—Ä–µ–≥—Ç–∏ –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–µ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è",
        "encrypted_message.txt",    // –ó–∞–ø—Ä–æ–ø–æ–Ω–æ–≤–∞–Ω–µ —ñ–º'—è.
        "Text Files (*.txt);;All Files (*)"
        );

    if (fileName.isEmpty()) {
        return;
    }

    // ========== –ö–†–û–ö 4: –ó–∞–ø–∏—Å —É —Ñ–∞–π–ª ==========

    QFile file(fileName);
    if (!file.open(QIODevice::WriteOnly | QIODevice::Text)) {
        QMessageBox::critical(this, "–ü–æ–º–∏–ª–∫–∞", "–ù–µ –≤–¥–∞–ª–æ—Å—è –∑–±–µ—Ä–µ–≥—Ç–∏ —Ñ–∞–π–ª!");
        return;
    }

    // –ó–∞–ø–∏—Å—É—î–º–æ —á–∏—Å—Ç–∏–π Base64 —Ä—è–¥–æ–∫.
    QTextStream out(&file);
    out << text;
    file.close();

    // –ü–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –ø—Ä–æ —É—Å–ø—ñ—Ö.
    QMessageBox::information(
        this,
        "–£—Å–ø—ñ—Ö",
        QString("–ó–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–µ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –∑–±–µ—Ä–µ–∂–µ–Ω–æ —É —Ñ–∞–π–ª:\n%1").arg(fileName)
        );
}

/**
 * @brief –û—á–∏—â–µ–Ω–Ω—è –≤—Å—ñ—Ö –ø–æ–ª—ñ–≤ –≤–∫–ª–∞–¥–∫–∏ —à–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è.
 *
 * –°–∫–∏–¥–∞—î –≤—Å—ñ –¥–∞–Ω—ñ –¥–æ –ø–æ—á–∞—Ç–∫–æ–≤–æ–≥–æ —Å—Ç–∞–Ω—É:
 * - –û—á–∏—â–∞—î —à–ª—è—Ö –¥–æ –∫–ª—é—á–∞ —Ç–∞ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è.
 * - –û—á–∏—â–∞—î –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–µ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è.
 * - –û—á–∏—â–∞—î —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é –ø—Ä–æ —Ñ–∞–π–ª.
 * - –í–∏–¥–∞–ª—è—î –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω—ñ –¥–∞–Ω—ñ –∑ –ø–∞–º'—è—Ç—ñ.
 * - –î–µ–∞–∫—Ç–∏–≤—É—î –∫–Ω–æ–ø–∫—É –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è.
 */
void EmailEncryptorWindow::clearEncryptTab() {
    // –û—á–∏—â–µ–Ω–Ω—è –ø–æ–ª—ñ–≤ UI.
    encrypt_keyPathEdit->clear();
    encrypt_messageEdit->clear();
    encrypt_encryptedEdit->clear();
    encrypt_filePathEdit->clear();
    encrypt_fileInfoLabel->clear();

    // –í–∏–¥–∞–ª–µ–Ω–Ω—è –¥–∞–Ω–∏—Ö –∑ –ø–∞–º'—è—Ç—ñ.
    encryptionKey.clear();          // –ö–ª—é—á —à–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è.
    encryptFilePath.clear();        // –®–ª—è—Ö –¥–æ —Ñ–∞–π–ª—É.
    encryptFileData.clear();        // –ë–∞–π—Ç–∏ —Ñ–∞–π–ª—É.

    // –î–µ–∞–∫—Ç–∏–≤–∞—Ü—ñ—è –∫–Ω–æ–ø–∫–∏ –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è.
    encrypt_saveMessageBtn->setEnabled(false);
}

/*
 * ============================================================================
 * –û–ë–†–û–ë–ù–ò–ö–ò –í–ö–õ–ê–î–ö–ò –†–û–ó–®–ò–§–†–£–í–ê–ù–ù–Ø
 * ============================================================================
 */

/**
 * @brief –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –∫–ª—é—á–∞ —Ä–æ–∑—à–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è –∑ —Ñ–∞–π–ª—É.
 *
 * –í–ê–ñ–õ–ò–í–û: –¶–µ –º–∞—î –±—É—Ç–∏ —Ç–æ–π —Å–∞–º–∏–π –∫–ª—é—á, —â–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞–≤—Å—è –¥–ª—è —à–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è!
 * –°–∏–º–µ—Ç—Ä–∏—á–Ω–µ —à–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î –æ–¥–∏–Ω –∫–ª—é—á –¥–ª—è –æ–±–æ—Ö –æ–ø–µ—Ä–∞—Ü—ñ–π.
 *
 * –ü—Ä–æ—Ü–µ—Å —ñ–¥–µ–Ω—Ç–∏—á–Ω–∏–π loadEncryptionKey(), –∞–ª–µ:
 * - –ó–±–µ—Ä—ñ–≥–∞—î –∫–ª—é—á —É –∑–º—ñ–Ω–Ω—É decryptionKey.
 * - –í—ñ–¥–æ–±—Ä–∞–∂–∞—î —É –ø–æ–ª—è—Ö –≤–∫–ª–∞–¥–∫–∏ —Ä–æ–∑—à–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è.
 */
void EmailEncryptorWindow::loadDecryptionKey() {
    // –î—ñ–∞–ª–æ–≥ –≤–∏–±–æ—Ä—É —Ñ–∞–π–ª—É.
    QString fileName = QFileDialog::getOpenFileName(
        this,
        "–ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ –∫–ª—é—á —Ä–æ–∑—à–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è",
        "",
        "Text Files (*.txt);;All Files (*)"
        );

    if (fileName.isEmpty()) {
        return;
    }

    // –ß–∏—Ç–∞–Ω–Ω—è –∫–ª—é—á–∞ –∑ —Ñ–∞–π–ª—É.
    QFile file(fileName);
    if (!file.open(QIODevice::ReadOnly | QIODevice::Text)) {
        QMessageBox::critical(this, "–ü–æ–º–∏–ª–∫–∞", "–ù–µ –≤–¥–∞–ª–æ—Å—è –≤—ñ–¥–∫—Ä–∏—Ç–∏ —Ñ–∞–π–ª!");
        return;
    }

    QTextStream in(&file);
    // –ó–±–µ—Ä—ñ–≥–∞—î–º–æ —É decryptionKey.
    decryptionKey = in.readAll().trimmed();
    file.close();

    // –í—ñ–¥–æ–±—Ä–∞–∂–µ–Ω–Ω—è —à–ª—è—Ö—É.
    decrypt_keyPathEdit->setText(fileName);

    QMessageBox::information(
        this,
        "–£—Å–ø—ñ—Ö",
        "–ö–ª—é—á —Ä–æ–∑—à–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è —É—Å–ø—ñ—à–Ω–æ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–æ!"
        );

    // –ù–∞–ª–∞–≥–æ–¥–∂–µ–Ω–Ω—è.
    qDebug() << "Decryption key loaded from:" << fileName;
    qDebug() << "Key:" << decryptionKey;
}

/**
 * @brief –†–æ–∑—à–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è —Ç–µ–∫—Å—Ç–æ–≤–æ–≥–æ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è.
 *
 * –ê–ª–≥–æ—Ä–∏—Ç–º —Ä–æ–±–æ—Ç–∏:
 * 1. –ü–µ—Ä–µ–≤—ñ—Ä—è—î –Ω–∞—è–≤–Ω—ñ—Å—Ç—å –∫–ª—é—á–∞ —Ç–∞ –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–æ–≥–æ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è.
 * 2. –í–∏–∫–ª–∏–∫–∞—î –¥–≤–∏–∂–æ–∫ —Ä–æ–∑—à–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è (Base64 ‚Üí XOR ‚Üí —Ç–µ–∫—Å—Ç).
 * 3. –í—ñ–¥–æ–±—Ä–∞–∂–∞—î –æ—Ä–∏–≥—ñ–Ω–∞–ª—å–Ω–∏–π —Ç–µ–∫—Å—Ç.
 * 4. –û–±—Ä–æ–±–ª—è—î –ø–æ–º–∏–ª–∫–∏ (–Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∏–π –∫–ª—é—á, –ø–æ—à–∫–æ–¥–∂–µ–Ω—ñ –¥–∞–Ω—ñ).
 *
 * –ü—Ä–æ—Ü–µ—Å —Ä–æ–∑—à–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è (–≤ EncryptionEngine):
 * - Base64 ‚Üí –±–∞–π—Ç–∏.
 * - Hex-–∫–ª—é—á ‚Üí –±–∞–π—Ç–∏.
 * - XOR –±–∞–π—Ç-–ø–æ-–±–∞–π—Ç—É.
 * - –ë–∞–π—Ç–∏ ‚Üí UTF-8 —Ç–µ–∫—Å—Ç.
 *
 * –ú–∞–≥—ñ—è XOR: encrypted XOR key = original.
 */
void EmailEncryptorWindow::decryptMessage() {
    // ========== –ö–†–û–ö 1: –í–∞–ª—ñ–¥–∞—Ü—ñ—è –≤—Ö—ñ–¥–Ω–∏—Ö –¥–∞–Ω–∏—Ö ==========

    if (decryptionKey.isEmpty()) {
        QMessageBox::warning(
            this,
            "–ü–æ–º–∏–ª–∫–∞",
            "–°–ø–æ—á–∞—Ç–∫—É –∑–∞–≤–∞–Ω—Ç–∞–∂—Ç–µ –∫–ª—é—á —Ä–æ–∑—à–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è!"
            );
        return;
    }

    // –ó—á–∏—Ç—É—î–º–æ –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–µ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è (Base64 —Ä—è–¥–æ–∫).
    QString encryptedMessage = decrypt_encryptedEdit->toPlainText().trimmed();
    if (encryptedMessage.isEmpty()) {
        QMessageBox::warning(
            this,
            "–ü–æ–º–∏–ª–∫–∞",
            "–í–≤–µ–¥—ñ—Ç—å –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–µ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è!"
            );
        return;
    }

    // ========== –ö–†–û–ö 2: –°–ø—Ä–æ–±–∞ —Ä–æ–∑—à–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è ==========

    try {
        // –î–≤–∏–∂–æ–∫ –≤–∏–∫–æ–Ω—É—î:
        // 1. Base64 decode ‚Üí –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω—ñ –±–∞–π—Ç–∏.
        // 2. Hex-–∫–ª—é—á ‚Üí –±–∞–π—Ç–∏ –∫–ª—é—á–∞.
        // 3. XOR –º—ñ–∂ –Ω–∏–º–∏ ‚Üí –æ—Ä–∏–≥—ñ–Ω–∞–ª—å–Ω—ñ –±–∞–π—Ç–∏.
        // 4. UTF-8 decode ‚Üí —Ç–µ–∫—Å—Ç.
        QString decrypted = encryptionEngine->decryptMessage(
            encryptedMessage,
            decryptionKey
            );

        // ========== –ö–†–û–ö 3: –í—ñ–¥–æ–±—Ä–∞–∂–µ–Ω–Ω—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç—É ==========

        // –í–∏–≤–æ–¥–∏–º–æ —Ä–æ–∑—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–π —Ç–µ–∫—Å—Ç (–±–µ–∑ –¥–æ–¥–∞—Ç–∫–æ–≤–æ–≥–æ —Ñ–æ—Ä–º–∞—Ç—É–≤–∞–Ω–Ω—è).
        decrypt_decryptedEdit->setPlainText(decrypted);

        // ========== –ö–†–û–ö 4: –ü–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –ø—Ä–æ —É—Å–ø—ñ—Ö ==========

        QMessageBox::information(
            this,
            "–£—Å–ø—ñ—Ö",
            "–ü–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è —É—Å–ø—ñ—à–Ω–æ —Ä–æ–∑—à–∏—Ñ—Ä–æ–≤–∞–Ω–æ!\n\n"
            "–û—Ä–∏–≥—ñ–Ω–∞–ª—å–Ω–∏–π —Ç–µ–∫—Å—Ç –≤—ñ–¥–Ω–æ–≤–ª–µ–Ω–æ."
            );

        qDebug() << "Message decrypted successfully";
    }
    // ========== –û–ë–†–û–ë–ö–ê –ü–û–ú–ò–õ–û–ö ==========
    catch (...) {
        // –õ–æ–≤–∏–º–æ –±—É–¥—å-—è–∫—ñ –ø–æ–º–∏–ª–∫–∏ —Ä–æ–∑—à–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è:
        // - –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∏–π Base64.
        // - –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∏–π –∫–ª—é—á.
        // - –ù–µ–∫–æ—Ä–µ–∫—Ç–Ω–µ UTF-8 –∫–æ–¥—É–≤–∞–Ω–Ω—è.
        QMessageBox::critical(
            this,
            "–ü–æ–º–∏–ª–∫–∞",
            "–ù–µ –≤–¥–∞–ª–æ—Å—è —Ä–æ–∑—à–∏—Ñ—Ä—É–≤–∞—Ç–∏ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è!\n\n"
            "–ú–æ–∂–ª–∏–≤—ñ –ø—Ä–∏—á–∏–Ω–∏:\n"
            "‚Ä¢ –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∏–π –∫–ª—é—á —Ä–æ–∑—à–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è\n"
            "‚Ä¢ –ü–æ—à–∫–æ–¥–∂–µ–Ω—ñ –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω—ñ –¥–∞–Ω—ñ\n"
            "‚Ä¢ –ù–µ–∫–æ—Ä–µ–∫—Ç–Ω–∏–π —Ñ–æ—Ä–º–∞—Ç –¥–∞–Ω–∏—Ö"
            );
    }
}

/**
 * @brief –í–∏–±—ñ—Ä –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–æ–≥–æ —Ñ–∞–π–ª—É –¥–ª—è —Ä–æ–∑—à–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è.
 *
 * –ü—Ä–æ—Ü–µ—Å —ñ–¥–µ–Ω—Ç–∏—á–Ω–∏–π selectFileToEncrypt(), –∞–ª–µ:
 * - –§—ñ–ª—å—Ç—Ä—É—î —Ñ–∞–π–ª–∏ –∑ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è–º .encrypted.
 * - –ó–±–µ—Ä—ñ–≥–∞—î –¥–∞–Ω—ñ —É –∑–º—ñ–Ω–Ω—É decryptFileData.
 * - –í—ñ–¥–æ–±—Ä–∞–∂–∞—î —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é –Ω–∞ –≤–∫–ª–∞–¥—Ü—ñ —Ä–æ–∑—à–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è.
 */
void EmailEncryptorWindow::selectFileToDecrypt() {
    // –î—ñ–∞–ª–æ–≥ –≤–∏–±–æ—Ä—É (–∑ —Ñ—ñ–ª—å—Ç—Ä–æ–º .encrypted).
    QString fileName = QFileDialog::getOpenFileName(
        this,
        "–í–∏–±–µ—Ä—ñ—Ç—å –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–π —Ñ–∞–π–ª",
        "",
        "Encrypted Files (*.encrypted);;All Files (*)"
        );

    if (fileName.isEmpty()) {
        return;
    }

    // –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —Ñ–∞–π–ª—É.
    QFile file(fileName);
    if (!file.open(QIODevice::ReadOnly)) {
        QMessageBox::critical(this, "–ü–æ–º–∏–ª–∫–∞", "–ù–µ –≤–¥–∞–ª–æ—Å—è –≤—ñ–¥–∫—Ä–∏—Ç–∏ —Ñ–∞–π–ª!");
        return;
    }

    // –ß–∏—Ç–∞—î–º–æ –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω—ñ –±–∞–π—Ç–∏.
    decryptFileData = file.readAll();
    file.close();

    // –ó–±–µ—Ä–µ–∂–µ–Ω–Ω—è –º–µ—Ç–∞–¥–∞–Ω–∏—Ö.
    decryptFilePath = fileName;
    decrypt_filePathEdit->setText(fileName);

    // –í—ñ–¥–æ–±—Ä–∞–∂–µ–Ω–Ω—è —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó.
    QFileInfo fileInfo(fileName);
    decrypt_fileInfoLabel->setText(
        QString("üìÑ %1 (%2 –±–∞–π—Ç)")
            .arg(fileInfo.fileName())
            .arg(decryptFileData.size())
        );

    // –ù–∞–ª–∞–≥–æ–¥–∂–µ–Ω–Ω—è.
    qDebug() << "File selected for decryption:" << fileName;
    qDebug() << "File size:" << decryptFileData.size() << "bytes";
}

/**
 * @brief –†–æ–∑—à–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è —Ñ–∞–π–ª—É —Ç–∞ –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç—É.
 *
 * –ê–ª–≥–æ—Ä–∏—Ç–º —Ä–æ–±–æ—Ç–∏:
 * 1. –ü–µ—Ä–µ–≤—ñ—Ä—è—î –Ω–∞—è–≤–Ω—ñ—Å—Ç—å –∫–ª—é—á–∞ —Ç–∞ —Ñ–∞–π–ª—É.
 * 2. –í–∏–∫–ª–∏–∫–∞—î –¥–≤–∏–∂–æ–∫ —Ä–æ–∑—à–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è (XOR).
 * 3. –ü—Ä–æ–ø–æ–Ω—É—î –∑–±–µ—Ä–µ–≥—Ç–∏ –∑ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–∏–º —ñ–º'—è–º (–±–µ–∑ .encrypted).
 * 4. –ó–±–µ—Ä—ñ–≥–∞—î —Ä–æ–∑—à–∏—Ñ—Ä–æ–≤–∞–Ω—ñ –±–∞–π—Ç–∏.
 * 5. –ü–æ–∫–∞–∑—É—î —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É.
 *
 * –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–µ —ñ–º'—è:
 * - document.pdf.encrypted ‚Üí document.pdf.
 * - –í–∏–¥–∞–ª—è—î—Ç—å—Å—è —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è .encrypted.
 *
 * –í–∏–∫–ª–∏–∫–∞—î—Ç—å—Å—è –ø—Ä–∏ –Ω–∞—Ç–∏—Å–∫–∞–Ω–Ω—ñ –∫–Ω–æ–ø–∫–∏ "üîì –†–æ–∑—à–∏—Ñ—Ä—É–≤–∞—Ç–∏ —Ñ–∞–π–ª".
 */
void EmailEncryptorWindow::decryptFile() {
    // ========== –ö–†–û–ö 1: –í–∞–ª—ñ–¥–∞—Ü—ñ—è ==========

    if (decryptionKey.isEmpty()) {
        QMessageBox::warning(
            this,
            "–ü–æ–º–∏–ª–∫–∞",
            "–°–ø–æ—á–∞—Ç–∫—É –∑–∞–≤–∞–Ω—Ç–∞–∂—Ç–µ –∫–ª—é—á —Ä–æ–∑—à–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è!"
            );
        return;
    }

    if (decryptFileData.isEmpty()) {
        QMessageBox::warning(this, "–ü–æ–º–∏–ª–∫–∞", "–°–ø–æ—á–∞—Ç–∫—É –≤–∏–±–µ—Ä—ñ—Ç—å —Ñ–∞–π–ª!");
        return;
    }

    // ========== –ö–†–û–ö 2: –†–æ–∑—à–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è ==========

    try {
        // –î–≤–∏–∂–æ–∫ –≤–∏–∫–æ–Ω—É—î –∑–≤–æ—Ä–æ—Ç–Ω–∏–π XOR:
        // encrypted[i] XOR key[i] = original[i].
        decryptedFileData = encryptionEngine->decryptFile(
            decryptFileData,     // –ó–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω—ñ –±–∞–π—Ç–∏.
            decryptionKey        // Hex-–∫–ª—é—á.
            );

        // ========== –ö–†–û–ö 3: –î—ñ–∞–ª–æ–≥ –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è ==========

        // –ì–µ–Ω–µ—Ä—É—î–º–æ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–µ —ñ–º'—è (–≤–∏–¥–∞–ª—è—î–º–æ .encrypted).
        QString originalName = decryptFilePath;
        if (originalName.endsWith(".encrypted")) {
            // –í–∏–¥–∞–ª—è—î–º–æ –æ—Å—Ç–∞–Ω–Ω—ñ 10 —Å–∏–º–≤–æ–ª—ñ–≤ (".encrypted").
            originalName.chop(10);
        }

        // –ü—Ä–æ–ø–æ–Ω—É—î–º–æ –∑–±–µ—Ä–µ–≥—Ç–∏ —Ñ–∞–π–ª.
        QString saveFileName = QFileDialog::getSaveFileName(
            this,
            "–ó–±–µ—Ä–µ–≥—Ç–∏ —Ä–æ–∑—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–π —Ñ–∞–π–ª",
            originalName,        // –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–µ —ñ–º'—è –±–µ–∑ .encrypted.
            "All Files (*)"
            );

        // –Ø–∫—â–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á —Å–∫–∞—Å—É–≤–∞–≤ –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è.
        if (saveFileName.isEmpty()) {
            // –ü–æ–≤—ñ–¥–æ–º–ª—è—î–º–æ, —â–æ —Ä–æ–∑—à–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è –ø—Ä–æ–π—à–ª–æ, –∞–ª–µ —Ñ–∞–π–ª –Ω–µ –∑–±–µ—Ä–µ–∂–µ–Ω–æ.
            QMessageBox::information(
                this,
                "–†–æ–∑—à–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è –∑–∞–≤–µ—Ä—à–µ–Ω–æ",
                QString(
                    "–§–∞–π–ª —É—Å–ø—ñ—à–Ω–æ —Ä–æ–∑—à–∏—Ñ—Ä–æ–≤–∞–Ω–æ!\n\n"
                    "–ó–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–π —Ñ–∞–π–ª: %1 (%2 –±–∞–π—Ç)\n"
                    "–†–æ–∑—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–π —Ñ–∞–π–ª: %3 –±–∞–π—Ç\n\n"
                    "–§–∞–π–ª –Ω–µ –∑–±–µ—Ä–µ–∂–µ–Ω–æ."
                    ).arg(QFileInfo(decryptFilePath).fileName())
                    .arg(decryptFileData.size())
                    .arg(decryptedFileData.size())
                );
            return;
        }

        // ========== –ö–†–û–ö 4: –ó–±–µ—Ä–µ–∂–µ–Ω–Ω—è —Ñ–∞–π–ª—É ==========

        QFile file(saveFileName);
        if (!file.open(QIODevice::WriteOnly)) {
            QMessageBox::critical(this, "–ü–æ–º–∏–ª–∫–∞", "–ù–µ –≤–¥–∞–ª–æ—Å—è –∑–±–µ—Ä–µ–≥—Ç–∏ —Ñ–∞–π–ª!");
            return;
        }

        // –ó–∞–ø–∏—Å—É—î–º–æ —Ä–æ–∑—à–∏—Ñ—Ä–æ–≤–∞–Ω—ñ –±–∞–π—Ç–∏.
        file.write(decryptedFileData);
        file.close();

        // ========== –ö–†–û–ö 5: –ü–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –ø—Ä–æ —É—Å–ø—ñ—Ö ==========

        QMessageBox::information(
            this,
            "–£—Å–ø—ñ—Ö",
            QString(
                "–§–∞–π–ª —É—Å–ø—ñ—à–Ω–æ —Ä–æ–∑—à–∏—Ñ—Ä–æ–≤–∞–Ω–æ —Ç–∞ –∑–±–µ—Ä–µ–∂–µ–Ω–æ!\n\n"
                "–ó–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–π —Ñ–∞–π–ª: %1 (%2 –±–∞–π—Ç)\n"
                "–†–æ–∑—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–π —Ñ–∞–π–ª: %3 (%4 –±–∞–π—Ç)\n\n"
                "–ó–±–µ—Ä–µ–∂–µ–Ω–æ —è–∫: %5"
                ).arg(QFileInfo(decryptFilePath).fileName())
                .arg(decryptFileData.size())
                .arg(QFileInfo(saveFileName).fileName())
                .arg(decryptedFileData.size())
                .arg(saveFileName)
            );

        qDebug() << "File decrypted and saved to:" << saveFileName;
    }
    // ========== –û–ë–†–û–ë–ö–ê –ü–û–ú–ò–õ–û–ö ==========
    catch (...) {
        // –ü–æ–º–∏–ª–∫–∏ —Ä–æ–∑—à–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è —Ñ–∞–π–ª—É:
        // - –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∏–π –∫–ª—é—á.
        // - –ü–æ—à–∫–æ–¥–∂–µ–Ω–∏–π —Ñ–∞–π–ª.
        QMessageBox::critical(
            this,
            "–ü–æ–º–∏–ª–∫–∞",
            "–ù–µ –≤–¥–∞–ª–æ—Å—è —Ä–æ–∑—à–∏—Ñ—Ä—É–≤–∞—Ç–∏ —Ñ–∞–π–ª!\n\n"
            "–ú–æ–∂–ª–∏–≤—ñ –ø—Ä–∏—á–∏–Ω–∏:\n"
            "‚Ä¢ –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∏–π –∫–ª—é—á —Ä–æ–∑—à–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è\n"
            "‚Ä¢ –ü–æ—à–∫–æ–¥–∂–µ–Ω–∏–π –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–π —Ñ–∞–π–ª"
            );
    }
}

/**
 * @brief –ó–±–µ—Ä–µ–∂–µ–Ω–Ω—è —Ä–æ–∑—à–∏—Ñ—Ä–æ–≤–∞–Ω–æ–≥–æ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è —É —Ñ–∞–π–ª.
 *
 * –ó–±–µ—Ä—ñ–≥–∞—î —á–∏—Å—Ç–∏–π —Ä–æ–∑—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–π —Ç–µ–∫—Å—Ç (–±–µ–∑ —Ñ–æ—Ä–º–∞—Ç—É–≤–∞–Ω–Ω—è).
 *
 * –ü—Ä–æ—Ü–µ—Å:
 * 1. –ü–µ—Ä–µ–≤—ñ—Ä—è—î –Ω–∞—è–≤–Ω—ñ—Å—Ç—å —Ä–æ–∑—à–∏—Ñ—Ä–æ–≤–∞–Ω–æ–≥–æ —Ç–µ–∫—Å—Ç—É.
 * 2. –ü—Ä–æ–ø–æ–Ω—É—î –∑–±–µ—Ä–µ–≥—Ç–∏ —É .txt —Ñ–∞–π–ª.
 * 3. –ó–∞–ø–∏—Å—É—î —Ç–µ–∫—Å—Ç as-is (–±–µ–∑ –∑–º—ñ–Ω).
 */
void EmailEncryptorWindow::saveDecryptedFile() {
    // –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –Ω–∞—è–≤–Ω–æ—Å—Ç—ñ —Ç–µ–∫—Å—Ç—É.
    QString text = decrypt_decryptedEdit->toPlainText();
    if (text.isEmpty()) {
        QMessageBox::warning(
            this,
            "–ü–æ–º–∏–ª–∫–∞",
            "–ù–µ–º–∞—î —Ä–æ–∑—à–∏—Ñ—Ä–æ–≤–∞–Ω–æ–≥–æ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è!"
            );
        return;
    }

    // –î—ñ–∞–ª–æ–≥ –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è.
    QString fileName = QFileDialog::getSaveFileName(
        this,
        "–ó–±–µ—Ä–µ–≥—Ç–∏ —Ä–æ–∑—à–∏—Ñ—Ä–æ–≤–∞–Ω–µ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è",
        "decrypted_message.txt",
        "Text Files (*.txt);;All Files (*)"
        );

    if (fileName.isEmpty()) {
        return;
    }

    // –ó–∞–ø–∏—Å —É —Ñ–∞–π–ª.
    QFile file(fileName);
    if (!file.open(QIODevice::WriteOnly | QIODevice::Text)) {
        QMessageBox::critical(this, "–ü–æ–º–∏–ª–∫–∞", "–ù–µ –≤–¥–∞–ª–æ—Å—è –∑–±–µ—Ä–µ–≥—Ç–∏ —Ñ–∞–π–ª!");
        return;
    }

    QTextStream out(&file);
    out << text;
    file.close();

    QMessageBox::information(
        this,
        "–£—Å–ø—ñ—Ö",
        QString("–†–æ–∑—à–∏—Ñ—Ä–æ–≤–∞–Ω–µ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –∑–±–µ—Ä–µ–∂–µ–Ω–æ —É —Ñ–∞–π–ª:\n%1").arg(fileName)
        );

    qDebug() << "Decrypted message saved to:" << fileName;
}

/**
 * @brief –û—á–∏—â–µ–Ω–Ω—è –≤—Å—ñ—Ö –ø–æ–ª—ñ–≤ –≤–∫–ª–∞–¥–∫–∏ —Ä–æ–∑—à–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è.
 *
 * –°–∫–∏–¥–∞—î –≤—Å—ñ –¥–∞–Ω—ñ –¥–æ –ø–æ—á–∞—Ç–∫–æ–≤–æ–≥–æ —Å—Ç–∞–Ω—É:
 * - –û—á–∏—â–∞—î –ø–æ–ª—è –∫–ª—é—á–∞, –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å, —Ñ–∞–π–ª—ñ–≤.
 * - –í–∏–¥–∞–ª—è—î –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω—ñ —Ç–∞ —Ä–æ–∑—à–∏—Ñ—Ä–æ–≤–∞–Ω—ñ –¥–∞–Ω—ñ –∑ –ø–∞–º'—è—Ç—ñ.
 * - –î–µ–∞–∫—Ç–∏–≤—É—î –∫–Ω–æ–ø–∫—É –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è.
 */
void EmailEncryptorWindow::clearDecryptTab() {
    // –û—á–∏—â–µ–Ω–Ω—è –ø–æ–ª—ñ–≤ UI.
    decrypt_keyPathEdit->clear();
    decrypt_encryptedEdit->clear();
    decrypt_decryptedEdit->clear();
    decrypt_filePathEdit->clear();
    decrypt_fileInfoLabel->clear();

    // –í–∏–¥–∞–ª–µ–Ω–Ω—è –¥–∞–Ω–∏—Ö –∑ –ø–∞–º'—è—Ç—ñ.
    decryptionKey.clear();          // –ö–ª—é—á.
    decryptFilePath.clear();        // –®–ª—è—Ö.
    decryptFileData.clear();        // –ó–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω—ñ –±–∞–π—Ç–∏.
    decryptedFileData.clear();      // –†–æ–∑—à–∏—Ñ—Ä–æ–≤–∞–Ω—ñ –±–∞–π—Ç–∏.

    // –î–µ–∞–∫—Ç–∏–≤–∞—Ü—ñ—è –∫–Ω–æ–ø–∫–∏.
    decrypt_saveFileBtn->setEnabled(false);
}
